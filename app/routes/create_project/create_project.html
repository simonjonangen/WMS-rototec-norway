{% extends "layout.html" %}

{% block content %}
<section id="hero" class="hero section dark-background">

  <!-- Background image -->
  <img src="{{ url_for('static', filename='assets/img/hero-bg.jpg') }}" alt="" data-aos="fade-in">

  <div class="container" data-aos="fade-up" data-aos-delay="100">

    <!-- Title block styled and centered -->
    <div class="container section-title text-center" data-aos="fade-up">
      <h2>Create New Project</h2>
      <p>Define project details and required materials</p>
    </div>

    <!-- Centered Form -->
    <div class="row justify-content-center">
      <div class="col-md-8">
        <form id="projectForm">
          <!-- Project Number -->
          <div class="mb-3">
            <label for="projectNumber" class="form-label text-white">Project Number</label>
            <input type="text" class="form-control" id="projectNumber" name="projectNumber" required>
          </div>

          <div class="mb-3">
            <label for="customerName" class="form-label text-white">Customer Address</label>
            <input type="text" class="form-control" id="customerName" name="customerName" required>
          </div>

          <!-- Workers Selection -->
          <div class="mb-3">
            <label class="form-label text-white">Assigned Workers</label>
            <div class="input-group mb-2">
              <input type="text" class="form-control" id="workerSearch" placeholder="Search workers...">
              <button class="btn btn-primary" type="button" id="clearWorkerSearch">Clear</button>
            </div>
            <div class="workers-list bg-dark p-2 rounded" style="max-height: 150px; overflow-y: auto;">
              {% for worker in workers %}
                <div class="worker-item p-2 mb-1 rounded"
                     data-username="{{ worker.username }}"
                     onclick="toggleWorkerSelection(this)">
                  {{ worker.name }} ({{ worker.username }})
                </div>
              {% endfor %}
            </div>
            <div class="selected-workers mt-2">
              <small class="text-white">Selected workers: </small>
              <div id="selectedWorkersList" class="d-flex flex-wrap gap-2 mt-1"></div>
            </div>
          </div>

          <!-- Date Range -->
          <div class="row mb-3">
            <div class="col-md-6">
              <label for="startDate" class="form-label text-white">Start Date</label>
              <input type="date" class="form-control" id="startDate" name="startDate" required>
            </div>
            <div class="col-md-6">
              <label for="endDate" class="form-label text-white">End Date</label>
              <input type="date" class="form-control" id="endDate" name="endDate" required>
            </div>
          </div>

          <!-- Shopping List -->
          <div class="mb-3">
            <label class="form-label text-white">Required Materials</label>
            <div class="input-group mb-2">
              <input type="text" class="form-control" id="itemSearch" placeholder="Search items by name...">
              <button class="btn btn-primary" type="button" id="addItem">Add</button>
            </div>
            <div class="search-results bg-dark p-2 rounded d-none" style="max-height: 200px; overflow-y: auto;">
              <!-- Search results will appear here -->
            </div>
            <table class="table table-dark table-striped mt-2" id="itemsTable">
              <thead>
                <tr>
                  <th>Item ID</th>
                  <th>Item Name</th>
                  <th>Quantity</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody>
                <!-- Will be populated by JavaScript -->
              </tbody>
            </table>
          </div>

          <!-- Submit Button -->
          <div class="row justify-content-center mt-4">
            <div class="col-xl-4 col-md-4" data-aos="fade-up" data-aos-delay="300">
              <button type="submit" class="w-100 border-0 bg-transparent p-0 text-white">
                <div class="icon-box text-center py-3" style="cursor: pointer;">
                  <i class="bi bi-folder-plus" style="font-size: 1.5rem;"></i>
                  <h3 class="mt-2" style="font-size: 1rem;">
                    Create Project
                  </h3>
                </div>
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</section>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="{{ url_for('create_project.create_project_js', filename='create_project.js') }}"></script>
{% endblock %}